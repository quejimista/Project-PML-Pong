>>> Training starts at 2025-11-25 22:17:32.505785
>>> Hyperparameters:
    LR: 0.0001, Batch: 32, Gamma: 0.99
    Epsilon: 1.0 -> 0.01 (decay: 0.995)
    Update freq: 8, Sync freq: 1000
Filling replay buffer...
Buffer filled with 10000 experiences

=== BUFFER DIVERSITY CHECK ===
Sample states shape: (100, 4, 84, 84)
State mean: 0.4037
State std: 0.1905
Unique values check: 50
=== CHECK COMPLETE ===

Training a DQN network with Prioritized Replay Buffer
EPISODE 1 COMPLETED
======================================================================
Total Steps: 11108 | Episode Steps: 1108
Episode Reward: -19.00 | Mean Reward: -19.00
Loss: 0.00294 | Epsilon: 1.000
Beta: 0.467


EPISODE 2 COMPLETED
======================================================================
Total Steps: 11890 | Episode Steps: 782
Episode Reward: -21.00 | Mean Reward: -20.00
Loss: 0.00460 | Epsilon: 0.995
Beta: 0.471


EPISODE 3 COMPLETED
======================================================================
Total Steps: 12731 | Episode Steps: 841
Episode Reward: -20.00 | Mean Reward: -20.00
Loss: 0.00605 | Epsilon: 0.990
Beta: 0.476


EPISODE 4 COMPLETED
======================================================================
Total Steps: 13779 | Episode Steps: 1048
Episode Reward: -20.00 | Mean Reward: -20.00
Loss: 0.01498 | Epsilon: 0.985
Beta: 0.483


EPISODE 5 COMPLETED
======================================================================
Total Steps: 14602 | Episode Steps: 823
Episode Reward: -21.00 | Mean Reward: -20.20
Loss: 0.02461 | Epsilon: 0.980
Beta: 0.488


EPISODE 6 COMPLETED
======================================================================
Total Steps: 15518 | Episode Steps: 916
Episode Reward: -20.00 | Mean Reward: -20.17
Loss: 0.02851 | Epsilon: 0.975
Beta: 0.493


EPISODE 7 COMPLETED
======================================================================
Total Steps: 16630 | Episode Steps: 1112
Episode Reward: -17.00 | Mean Reward: -19.71
Loss: 0.02534 | Epsilon: 0.970
Beta: 0.500


EPISODE 8 COMPLETED
======================================================================
Total Steps: 17563 | Episode Steps: 933
Episode Reward: -21.00 | Mean Reward: -19.88
Loss: 0.02607 | Epsilon: 0.966
Beta: 0.505


EPISODE 9 COMPLETED
======================================================================
Total Steps: 18498 | Episode Steps: 935
Episode Reward: -19.00 | Mean Reward: -19.78
Loss: 0.02338 | Epsilon: 0.961
Beta: 0.511


EPISODE 10 COMPLETED
======================================================================
Total Steps: 19387 | Episode Steps: 889
Episode Reward: -21.00 | Mean Reward: -19.90
Loss: 0.02711 | Epsilon: 0.956
Beta: 0.516


EPISODE 11 COMPLETED
======================================================================
Total Steps: 20462 | Episode Steps: 1075
Episode Reward: -21.00 | Mean Reward: -20.00
Loss: 0.02464 | Epsilon: 0.951
Beta: 0.523


EPISODE 12 COMPLETED
======================================================================
Total Steps: 21285 | Episode Steps: 823
Episode Reward: -21.00 | Mean Reward: -20.08
Loss: 0.02479 | Epsilon: 0.946
Beta: 0.528


EPISODE 13 COMPLETED
======================================================================
Total Steps: 22339 | Episode Steps: 1054
Episode Reward: -18.00 | Mean Reward: -19.92
Loss: 0.02642 | Epsilon: 0.942
Beta: 0.534


EPISODE 14 COMPLETED
======================================================================
Total Steps: 23407 | Episode Steps: 1068
Episode Reward: -20.00 | Mean Reward: -19.93
Loss: 0.02843 | Epsilon: 0.937
Beta: 0.540


EPISODE 15 COMPLETED
======================================================================
Total Steps: 24531 | Episode Steps: 1124
Episode Reward: -19.00 | Mean Reward: -19.87
Loss: 0.02299 | Epsilon: 0.932
Beta: 0.547


EPISODE 16 COMPLETED
======================================================================
Total Steps: 25689 | Episode Steps: 1158
Episode Reward: -20.00 | Mean Reward: -19.88
Loss: 0.02449 | Epsilon: 0.928
Beta: 0.554


EPISODE 17 COMPLETED
======================================================================
Total Steps: 26587 | Episode Steps: 898
Episode Reward: -20.00 | Mean Reward: -19.88
Loss: 0.02341 | Epsilon: 0.923
Beta: 0.560


EPISODE 18 COMPLETED
======================================================================
Total Steps: 27459 | Episode Steps: 872
Episode Reward: -21.00 | Mean Reward: -19.94
Loss: 0.02282 | Epsilon: 0.918
Beta: 0.565


EPISODE 19 COMPLETED
======================================================================
Total Steps: 28330 | Episode Steps: 871
Episode Reward: -21.00 | Mean Reward: -20.00
Loss: 0.02357 | Epsilon: 0.914
Beta: 0.570


EPISODE 20 COMPLETED
======================================================================
Total Steps: 29312 | Episode Steps: 982
Episode Reward: -21.00 | Mean Reward: -20.05
Loss: 0.02406 | Epsilon: 0.909
Beta: 0.576


EPISODE 21 COMPLETED
======================================================================
Total Steps: 30360 | Episode Steps: 1048
Episode Reward: -20.00 | Mean Reward: -20.05
Loss: 0.01985 | Epsilon: 0.905
Beta: 0.582


EPISODE 22 COMPLETED
======================================================================
Total Steps: 31257 | Episode Steps: 897
Episode Reward: -20.00 | Mean Reward: -20.05
Loss: 0.02008 | Epsilon: 0.900
Beta: 0.588


EPISODE 23 COMPLETED
======================================================================
Total Steps: 32364 | Episode Steps: 1107
Episode Reward: -18.00 | Mean Reward: -19.96
Loss: 0.01901 | Epsilon: 0.896
Beta: 0.594


EPISODE 24 COMPLETED
======================================================================
Total Steps: 33335 | Episode Steps: 971
Episode Reward: -19.00 | Mean Reward: -19.92
Loss: 0.01712 | Epsilon: 0.891
Beta: 0.600


EPISODE 25 COMPLETED
======================================================================
Total Steps: 34178 | Episode Steps: 843
Episode Reward: -21.00 | Mean Reward: -19.96
Loss: 0.01368 | Epsilon: 0.887
Beta: 0.605


EPISODE 26 COMPLETED
======================================================================
Total Steps: 35247 | Episode Steps: 1069
Episode Reward: -20.00 | Mean Reward: -19.96
Loss: 0.01607 | Epsilon: 0.882
Beta: 0.611


EPISODE 27 COMPLETED
======================================================================
Total Steps: 36194 | Episode Steps: 947
Episode Reward: -21.00 | Mean Reward: -20.00
Loss: 0.01586 | Epsilon: 0.878
Beta: 0.617


EPISODE 28 COMPLETED
======================================================================
Total Steps: 37169 | Episode Steps: 975
Episode Reward: -21.00 | Mean Reward: -20.04
Loss: 0.01440 | Epsilon: 0.873
Beta: 0.623


EPISODE 29 COMPLETED
======================================================================
Total Steps: 37960 | Episode Steps: 791
Episode Reward: -21.00 | Mean Reward: -20.07
Loss: 0.01149 | Epsilon: 0.869
Beta: 0.628


EPISODE 30 COMPLETED
======================================================================
Total Steps: 38931 | Episode Steps: 971
Episode Reward: -21.00 | Mean Reward: -20.10
Loss: 0.01211 | Epsilon: 0.865
Beta: 0.634


EPISODE 31 COMPLETED
======================================================================
Total Steps: 39922 | Episode Steps: 991
Episode Reward: -20.00 | Mean Reward: -20.10
Loss: 0.01275 | Epsilon: 0.860
Beta: 0.640


EPISODE 32 COMPLETED
======================================================================
Total Steps: 40805 | Episode Steps: 883
Episode Reward: -21.00 | Mean Reward: -20.12
Loss: 0.01251 | Epsilon: 0.856
Beta: 0.645


EPISODE 33 COMPLETED
======================================================================
Total Steps: 41701 | Episode Steps: 896
Episode Reward: -20.00 | Mean Reward: -20.12
Loss: 0.01133 | Epsilon: 0.852
Beta: 0.650


EPISODE 34 COMPLETED
======================================================================
Total Steps: 42631 | Episode Steps: 930
Episode Reward: -21.00 | Mean Reward: -20.15
Loss: 0.01076 | Epsilon: 0.848
Beta: 0.656


EPISODE 35 COMPLETED
======================================================================
Total Steps: 43413 | Episode Steps: 782
Episode Reward: -21.00 | Mean Reward: -20.17
Loss: 0.01038 | Epsilon: 0.843
Beta: 0.660


EPISODE 36 COMPLETED
======================================================================
Total Steps: 44236 | Episode Steps: 823
Episode Reward: -21.00 | Mean Reward: -20.19
Loss: 0.00965 | Epsilon: 0.839
Beta: 0.665


EPISODE 37 COMPLETED
======================================================================
Total Steps: 45211 | Episode Steps: 975
Episode Reward: -20.00 | Mean Reward: -20.19
Loss: 0.01111 | Epsilon: 0.835
Beta: 0.671


EPISODE 38 COMPLETED
======================================================================
Total Steps: 46148 | Episode Steps: 937
Episode Reward: -19.00 | Mean Reward: -20.16
Loss: 0.00968 | Epsilon: 0.831
Beta: 0.677


EPISODE 39 COMPLETED
======================================================================
Total Steps: 47235 | Episode Steps: 1087
Episode Reward: -20.00 | Mean Reward: -20.15
Loss: 0.01046 | Epsilon: 0.827
Beta: 0.683


EPISODE 40 COMPLETED
======================================================================
Total Steps: 48220 | Episode Steps: 985
Episode Reward: -20.00 | Mean Reward: -20.15
Loss: 0.00901 | Epsilon: 0.822
Beta: 0.689


EPISODE 41 COMPLETED
======================================================================
Total Steps: 49011 | Episode Steps: 791
Episode Reward: -21.00 | Mean Reward: -20.17
Loss: 0.00965 | Epsilon: 0.818
Beta: 0.694


EPISODE 42 COMPLETED
======================================================================
Total Steps: 49913 | Episode Steps: 902
Episode Reward: -21.00 | Mean Reward: -20.19
Loss: 0.00821 | Epsilon: 0.814
Beta: 0.699


EPISODE 43 COMPLETED
======================================================================
Total Steps: 50877 | Episode Steps: 964
Episode Reward: -20.00 | Mean Reward: -20.19
Loss: 0.00704 | Epsilon: 0.810
Beta: 0.705


EPISODE 44 COMPLETED
======================================================================
Total Steps: 51640 | Episode Steps: 763
Episode Reward: -21.00 | Mean Reward: -20.20
Loss: 0.00588 | Epsilon: 0.806
Beta: 0.710


EPISODE 45 COMPLETED
======================================================================
Total Steps: 52525 | Episode Steps: 885
Episode Reward: -21.00 | Mean Reward: -20.22
Loss: 0.00621 | Epsilon: 0.802
Beta: 0.715


EPISODE 46 COMPLETED
======================================================================
Total Steps: 53408 | Episode Steps: 883
Episode Reward: -21.00 | Mean Reward: -20.24
Loss: 0.00751 | Epsilon: 0.798
Beta: 0.720


EPISODE 47 COMPLETED
======================================================================
Total Steps: 54231 | Episode Steps: 823
Episode Reward: -21.00 | Mean Reward: -20.26
Loss: 0.00752 | Epsilon: 0.794
Beta: 0.725


EPISODE 48 COMPLETED
======================================================================
Total Steps: 55102 | Episode Steps: 871
Episode Reward: -20.00 | Mean Reward: -20.25
Loss: 0.00703 | Epsilon: 0.790
Beta: 0.731


EPISODE 49 COMPLETED
======================================================================
Total Steps: 55968 | Episode Steps: 866
Episode Reward: -20.00 | Mean Reward: -20.24
Loss: 0.00548 | Epsilon: 0.786
Beta: 0.736


EPISODE 50 COMPLETED
======================================================================
Total Steps: 56858 | Episode Steps: 890
Episode Reward: -21.00 | Mean Reward: -20.26
Loss: 0.00600 | Epsilon: 0.782
Beta: 0.741


Checkpoint saved: checkpoints\DQN_PER_ep_50.pt
Best model saved: checkpoints\DQN_PER_best_ep_50.pt
EPISODE 51 COMPLETED
======================================================================
Total Steps: 57794 | Episode Steps: 936
Episode Reward: -19.00 | Mean Reward: -20.24
Loss: 0.00589 | Epsilon: 0.778
Beta: 0.747


EPISODE 52 COMPLETED
======================================================================
Total Steps: 58761 | Episode Steps: 967
Episode Reward: -21.00 | Mean Reward: -20.25
Loss: 0.00641 | Epsilon: 0.774
Beta: 0.753


EPISODE 53 COMPLETED
======================================================================
Total Steps: 59665 | Episode Steps: 904
Episode Reward: -20.00 | Mean Reward: -20.25
Loss: 0.00590 | Epsilon: 0.771
Beta: 0.758


EPISODE 54 COMPLETED
======================================================================
Total Steps: 60717 | Episode Steps: 1052
Episode Reward: -18.00 | Mean Reward: -20.20
Loss: 0.00558 | Epsilon: 0.767
Beta: 0.764


EPISODE 55 COMPLETED
======================================================================
Total Steps: 61480 | Episode Steps: 763
Episode Reward: -21.00 | Mean Reward: -20.22
Loss: 0.00589 | Epsilon: 0.763
Beta: 0.769


EPISODE 56 COMPLETED
======================================================================
Total Steps: 62506 | Episode Steps: 1026
Episode Reward: -19.00 | Mean Reward: -20.20
Loss: 0.00634 | Epsilon: 0.759
Beta: 0.775


EPISODE 57 COMPLETED
======================================================================
Total Steps: 63343 | Episode Steps: 837
Episode Reward: -20.00 | Mean Reward: -20.19
Loss: 0.00588 | Epsilon: 0.755
Beta: 0.780


EPISODE 58 COMPLETED
======================================================================
Total Steps: 64246 | Episode Steps: 903
Episode Reward: -20.00 | Mean Reward: -20.19
Loss: 0.00534 | Epsilon: 0.751
Beta: 0.785


EPISODE 59 COMPLETED
======================================================================
Total Steps: 65158 | Episode Steps: 912
Episode Reward: -21.00 | Mean Reward: -20.20
Loss: 0.00497 | Epsilon: 0.748
Beta: 0.791


EPISODE 60 COMPLETED
======================================================================
Total Steps: 65921 | Episode Steps: 763
Episode Reward: -21.00 | Mean Reward: -20.22
Loss: 0.00490 | Epsilon: 0.744
Beta: 0.796


EPISODE 61 COMPLETED
======================================================================
Total Steps: 66761 | Episode Steps: 840
Episode Reward: -21.00 | Mean Reward: -20.23
Loss: 0.00447 | Epsilon: 0.740
Beta: 0.801


EPISODE 62 COMPLETED
======================================================================
Total Steps: 67680 | Episode Steps: 919
Episode Reward: -19.00 | Mean Reward: -20.21
Loss: 0.00437 | Epsilon: 0.737
Beta: 0.806


EPISODE 63 COMPLETED
======================================================================
Total Steps: 68628 | Episode Steps: 948
Episode Reward: -20.00 | Mean Reward: -20.21
Loss: 0.00448 | Epsilon: 0.733
Beta: 0.812


EPISODE 64 COMPLETED
======================================================================
Total Steps: 69470 | Episode Steps: 842
Episode Reward: -21.00 | Mean Reward: -20.22
Loss: 0.00426 | Epsilon: 0.729
Beta: 0.817


EPISODE 65 COMPLETED
======================================================================
Total Steps: 70411 | Episode Steps: 941
Episode Reward: -21.00 | Mean Reward: -20.23
Loss: 0.00472 | Epsilon: 0.726
Beta: 0.822


EPISODE 66 COMPLETED
======================================================================
Total Steps: 71234 | Episode Steps: 823
Episode Reward: -21.00 | Mean Reward: -20.24
Loss: 0.00420 | Epsilon: 0.722
Beta: 0.827


EPISODE 67 COMPLETED
======================================================================
Total Steps: 72315 | Episode Steps: 1081
Episode Reward: -20.00 | Mean Reward: -20.24
Loss: 0.00413 | Epsilon: 0.718
Beta: 0.834


EPISODE 68 COMPLETED
======================================================================
Total Steps: 73106 | Episode Steps: 791
Episode Reward: -21.00 | Mean Reward: -20.25
Loss: 0.00482 | Epsilon: 0.715
Beta: 0.839


EPISODE 69 COMPLETED
======================================================================
Total Steps: 74159 | Episode Steps: 1053
Episode Reward: -18.00 | Mean Reward: -20.22
Loss: 0.00427 | Epsilon: 0.711
Beta: 0.845


EPISODE 70 COMPLETED
======================================================================
Total Steps: 75061 | Episode Steps: 902
Episode Reward: -20.00 | Mean Reward: -20.21
Loss: 0.00430 | Epsilon: 0.708
Beta: 0.850


EPISODE 71 COMPLETED
======================================================================
Total Steps: 75915 | Episode Steps: 854
Episode Reward: -21.00 | Mean Reward: -20.23
Loss: 0.00432 | Epsilon: 0.704
Beta: 0.855


EPISODE 72 COMPLETED
======================================================================
Total Steps: 76971 | Episode Steps: 1056
Episode Reward: -19.00 | Mean Reward: -20.21
Loss: 0.00399 | Epsilon: 0.701
Beta: 0.862


EPISODE 73 COMPLETED
======================================================================
Total Steps: 77836 | Episode Steps: 865
Episode Reward: -20.00 | Mean Reward: -20.21
Loss: 0.00439 | Epsilon: 0.697
Beta: 0.867


EPISODE 74 COMPLETED
======================================================================
Total Steps: 78861 | Episode Steps: 1025
Episode Reward: -19.00 | Mean Reward: -20.19
Loss: 0.00474 | Epsilon: 0.694
Beta: 0.873


EPISODE 75 COMPLETED
======================================================================
Total Steps: 79941 | Episode Steps: 1080
Episode Reward: -20.00 | Mean Reward: -20.19
Loss: 0.00493 | Epsilon: 0.690
Beta: 0.880


EPISODE 76 COMPLETED
======================================================================
Total Steps: 80888 | Episode Steps: 947
Episode Reward: -19.00 | Mean Reward: -20.17
Loss: 0.00466 | Epsilon: 0.687
Beta: 0.885


EPISODE 77 COMPLETED
======================================================================
Total Steps: 81773 | Episode Steps: 885
Episode Reward: -21.00 | Mean Reward: -20.18
Loss: 0.00408 | Epsilon: 0.683
Beta: 0.891


EPISODE 78 COMPLETED
======================================================================
Total Steps: 82536 | Episode Steps: 763
Episode Reward: -21.00 | Mean Reward: -20.19
Loss: 0.00450 | Epsilon: 0.680
Beta: 0.895


EPISODE 79 COMPLETED
======================================================================
Total Steps: 83547 | Episode Steps: 1011
Episode Reward: -20.00 | Mean Reward: -20.19
Loss: 0.00440 | Epsilon: 0.676
Beta: 0.901


EPISODE 80 COMPLETED
======================================================================
Total Steps: 84444 | Episode Steps: 897
Episode Reward: -20.00 | Mean Reward: -20.19
Loss: 0.00408 | Epsilon: 0.673
Beta: 0.907


EPISODE 81 COMPLETED
======================================================================
Total Steps: 85327 | Episode Steps: 883
Episode Reward: -21.00 | Mean Reward: -20.20
Loss: 0.00462 | Epsilon: 0.670
Beta: 0.912


EPISODE 82 COMPLETED
======================================================================
Total Steps: 86296 | Episode Steps: 969
Episode Reward: -21.00 | Mean Reward: -20.21
Loss: 0.00403 | Epsilon: 0.666
Beta: 0.918


EPISODE 83 COMPLETED
======================================================================
Total Steps: 87149 | Episode Steps: 853
Episode Reward: -21.00 | Mean Reward: -20.22
Loss: 0.00381 | Epsilon: 0.663
Beta: 0.923


EPISODE 84 COMPLETED
======================================================================
Total Steps: 88081 | Episode Steps: 932
Episode Reward: -21.00 | Mean Reward: -20.23
Loss: 0.00386 | Epsilon: 0.660
Beta: 0.928


EPISODE 85 COMPLETED
======================================================================
Total Steps: 88998 | Episode Steps: 917
Episode Reward: -20.00 | Mean Reward: -20.22
Loss: 0.00377 | Epsilon: 0.656
Beta: 0.934


EPISODE 86 COMPLETED
======================================================================
Total Steps: 89808 | Episode Steps: 810
Episode Reward: -21.00 | Mean Reward: -20.23
Loss: 0.00366 | Epsilon: 0.653
Beta: 0.939


EPISODE 87 COMPLETED
======================================================================
Total Steps: 90755 | Episode Steps: 947
Episode Reward: -21.00 | Mean Reward: -20.24
Loss: 0.00405 | Epsilon: 0.650
Beta: 0.945


EPISODE 88 COMPLETED
======================================================================
Total Steps: 91793 | Episode Steps: 1038
Episode Reward: -20.00 | Mean Reward: -20.24
Loss: 0.00300 | Epsilon: 0.647
Beta: 0.951


EPISODE 89 COMPLETED
======================================================================
Total Steps: 92734 | Episode Steps: 941
Episode Reward: -21.00 | Mean Reward: -20.25
Loss: 0.00337 | Epsilon: 0.643
Beta: 0.956


EPISODE 90 COMPLETED
======================================================================
Total Steps: 93585 | Episode Steps: 851
Episode Reward: -21.00 | Mean Reward: -20.26
Loss: 0.00379 | Epsilon: 0.640
Beta: 0.962


EPISODE 91 COMPLETED
======================================================================
Total Steps: 94505 | Episode Steps: 920
Episode Reward: -20.00 | Mean Reward: -20.25
Loss: 0.00320 | Epsilon: 0.637
Beta: 0.967


EPISODE 92 COMPLETED
======================================================================
Total Steps: 95324 | Episode Steps: 819
Episode Reward: -21.00 | Mean Reward: -20.26
Loss: 0.00322 | Epsilon: 0.634
Beta: 0.972


EPISODE 93 COMPLETED
======================================================================
Total Steps: 96161 | Episode Steps: 837
Episode Reward: -20.00 | Mean Reward: -20.26
Loss: 0.00314 | Epsilon: 0.631
Beta: 0.977


EPISODE 94 COMPLETED
======================================================================
Total Steps: 96980 | Episode Steps: 819
Episode Reward: -21.00 | Mean Reward: -20.27
Loss: 0.00329 | Epsilon: 0.627
Beta: 0.982


EPISODE 95 COMPLETED
======================================================================
Total Steps: 97865 | Episode Steps: 885
Episode Reward: -21.00 | Mean Reward: -20.27
Loss: 0.00306 | Epsilon: 0.624
Beta: 0.987


EPISODE 96 COMPLETED
======================================================================
Total Steps: 98916 | Episode Steps: 1051
Episode Reward: -20.00 | Mean Reward: -20.27
Loss: 0.00368 | Epsilon: 0.621
Beta: 0.993


EPISODE 97 COMPLETED
======================================================================
Total Steps: 99741 | Episode Steps: 825
Episode Reward: -21.00 | Mean Reward: -20.28
Loss: 0.00331 | Epsilon: 0.618
Beta: 0.998


EPISODE 98 COMPLETED
======================================================================
Total Steps: 100674 | Episode Steps: 933
Episode Reward: -19.00 | Mean Reward: -20.27
Loss: 0.00288 | Epsilon: 0.615
Beta: 1.000


EPISODE 99 COMPLETED
======================================================================
Total Steps: 101608 | Episode Steps: 934
Episode Reward: -21.00 | Mean Reward: -20.27
Loss: 0.00333 | Epsilon: 0.612
Beta: 1.000


EPISODE 100 COMPLETED
======================================================================
Total Steps: 102509 | Episode Steps: 901
Episode Reward: -20.00 | Mean Reward: -20.27
Loss: 0.00260 | Epsilon: 0.609
Beta: 1.000


Checkpoint saved: checkpoints\DQN_PER_ep_100.pt
C:\Users\ainav\OneDrive\Documents\Uni\4th_year\1st_semester\paradigms_ml\project\Project-PML-Pong\Part_1\functions\Agent.py:421: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  best_checkpoint = torch.load(latest_best)
EPISODE 101 COMPLETED
======================================================================
Total Steps: 103300 | Episode Steps: 791
Episode Reward: -21.00 | Mean Reward: -20.29
Loss: 0.00315 | Epsilon: 0.606
Beta: 1.000


EPISODE 102 COMPLETED
======================================================================
Total Steps: 104169 | Episode Steps: 869
Episode Reward: -20.00 | Mean Reward: -20.28
Loss: 0.00306 | Epsilon: 0.603
Beta: 1.000


EPISODE 103 COMPLETED
======================================================================
Total Steps: 105074 | Episode Steps: 905
Episode Reward: -21.00 | Mean Reward: -20.29
Loss: 0.00278 | Epsilon: 0.600
Beta: 1.000


EPISODE 104 COMPLETED
======================================================================
Total Steps: 106139 | Episode Steps: 1065
Episode Reward: -20.00 | Mean Reward: -20.29
Loss: 0.00300 | Epsilon: 0.597
Beta: 1.000


EPISODE 105 COMPLETED
======================================================================
Total Steps: 107118 | Episode Steps: 979
Episode Reward: -20.00 | Mean Reward: -20.28
Loss: 0.00319 | Epsilon: 0.594
Beta: 1.000


EPISODE 106 COMPLETED
======================================================================
Total Steps: 108154 | Episode Steps: 1036
Episode Reward: -21.00 | Mean Reward: -20.29
Loss: 0.00325 | Epsilon: 0.591
Beta: 1.000


EPISODE 107 COMPLETED
======================================================================
Total Steps: 109139 | Episode Steps: 985
Episode Reward: -21.00 | Mean Reward: -20.33
Loss: 0.00277 | Epsilon: 0.588
Beta: 1.000


EPISODE 108 COMPLETED
======================================================================
Total Steps: 110010 | Episode Steps: 871
Episode Reward: -21.00 | Mean Reward: -20.33
Loss: 0.00302 | Epsilon: 0.585
Beta: 1.000


EPISODE 109 COMPLETED
======================================================================
Total Steps: 110955 | Episode Steps: 945
Episode Reward: -21.00 | Mean Reward: -20.35
Loss: 0.00333 | Epsilon: 0.582
Beta: 1.000


EPISODE 110 COMPLETED
======================================================================
Total Steps: 111737 | Episode Steps: 782
Episode Reward: -21.00 | Mean Reward: -20.35
Loss: 0.00332 | Epsilon: 0.579
Beta: 1.000


EPISODE 111 COMPLETED
======================================================================
Total Steps: 112782 | Episode Steps: 1045
Episode Reward: -20.00 | Mean Reward: -20.34
Loss: 0.00283 | Epsilon: 0.576
Beta: 1.000


EPISODE 112 COMPLETED
======================================================================
Total Steps: 113742 | Episode Steps: 960
Episode Reward: -20.00 | Mean Reward: -20.33
Loss: 0.00327 | Epsilon: 0.573
Beta: 1.000


EPISODE 113 COMPLETED
======================================================================
Total Steps: 114779 | Episode Steps: 1037
Episode Reward: -20.00 | Mean Reward: -20.35
Loss: 0.00327 | Epsilon: 0.570
Beta: 1.000


EPISODE 114 COMPLETED
======================================================================
Total Steps: 115735 | Episode Steps: 956
Episode Reward: -21.00 | Mean Reward: -20.36
Loss: 0.00305 | Epsilon: 0.568
Beta: 1.000


EPISODE 115 COMPLETED
======================================================================
Total Steps: 116665 | Episode Steps: 930
Episode Reward: -20.00 | Mean Reward: -20.37
Loss: 0.00292 | Epsilon: 0.565
Beta: 1.000


EPISODE 116 COMPLETED
======================================================================
Total Steps: 117807 | Episode Steps: 1142
Episode Reward: -21.00 | Mean Reward: -20.38
Loss: 0.00311 | Epsilon: 0.562
Beta: 1.000


EPISODE 117 COMPLETED
======================================================================
Total Steps: 118804 | Episode Steps: 997
Episode Reward: -19.00 | Mean Reward: -20.37
Loss: 0.00336 | Epsilon: 0.559
Beta: 1.000


EPISODE 118 COMPLETED
======================================================================
Total Steps: 119764 | Episode Steps: 960
Episode Reward: -20.00 | Mean Reward: -20.36
Loss: 0.00339 | Epsilon: 0.556
Beta: 1.000


EPISODE 119 COMPLETED
======================================================================
Total Steps: 120601 | Episode Steps: 837
Episode Reward: -20.00 | Mean Reward: -20.35
Loss: 0.00303 | Epsilon: 0.554
Beta: 1.000


EPISODE 120 COMPLETED
======================================================================
Total Steps: 121463 | Episode Steps: 862
Episode Reward: -21.00 | Mean Reward: -20.35
Loss: 0.00359 | Epsilon: 0.551
Beta: 1.000


EPISODE 121 COMPLETED
======================================================================
Total Steps: 122393 | Episode Steps: 930
Episode Reward: -20.00 | Mean Reward: -20.35
Loss: 0.00340 | Epsilon: 0.548
Beta: 1.000


EPISODE 122 COMPLETED
======================================================================
Total Steps: 123295 | Episode Steps: 902
Episode Reward: -20.00 | Mean Reward: -20.35
Loss: 0.00331 | Epsilon: 0.545
Beta: 1.000


EPISODE 123 COMPLETED
======================================================================
Total Steps: 124264 | Episode Steps: 969
Episode Reward: -21.00 | Mean Reward: -20.38
Loss: 0.00290 | Epsilon: 0.543
Beta: 1.000


EPISODE 124 COMPLETED
======================================================================
Total Steps: 125273 | Episode Steps: 1009
Episode Reward: -19.00 | Mean Reward: -20.38
Loss: 0.00359 | Epsilon: 0.540
Beta: 1.000


EPISODE 125 COMPLETED
======================================================================
Total Steps: 126094 | Episode Steps: 821
Episode Reward: -21.00 | Mean Reward: -20.38
Loss: 0.00356 | Epsilon: 0.537
Beta: 1.000


EPISODE 126 COMPLETED
======================================================================
Total Steps: 127297 | Episode Steps: 1203
Episode Reward: -17.00 | Mean Reward: -20.35
Loss: 0.00323 | Epsilon: 0.534
Beta: 1.000


EPISODE 127 COMPLETED
======================================================================
Total Steps: 128295 | Episode Steps: 998
Episode Reward: -20.00 | Mean Reward: -20.34
Loss: 0.00294 | Epsilon: 0.532
Beta: 1.000


EPISODE 128 COMPLETED
======================================================================
Total Steps: 129137 | Episode Steps: 842
Episode Reward: -21.00 | Mean Reward: -20.34
Loss: 0.00304 | Epsilon: 0.529
Beta: 1.000


EPISODE 129 COMPLETED
======================================================================
Total Steps: 130140 | Episode Steps: 1003
Episode Reward: -21.00 | Mean Reward: -20.34
Loss: 0.00308 | Epsilon: 0.526
Beta: 1.000


EPISODE 130 COMPLETED
======================================================================
Total Steps: 131023 | Episode Steps: 883
Episode Reward: -21.00 | Mean Reward: -20.34
Loss: 0.00363 | Epsilon: 0.524
Beta: 1.000


EPISODE 131 COMPLETED
======================================================================
Total Steps: 132237 | Episode Steps: 1214
Episode Reward: -18.00 | Mean Reward: -20.32
Loss: 0.00311 | Epsilon: 0.521
Beta: 1.000


EPISODE 132 COMPLETED
======================================================================
Total Steps: 133060 | Episode Steps: 823
Episode Reward: -21.00 | Mean Reward: -20.32
Loss: 0.00261 | Epsilon: 0.519
Beta: 1.000


EPISODE 133 COMPLETED
======================================================================
Total Steps: 134151 | Episode Steps: 1091
Episode Reward: -19.00 | Mean Reward: -20.31
Loss: 0.00292 | Epsilon: 0.516
Beta: 1.000


EPISODE 134 COMPLETED
======================================================================
Total Steps: 135031 | Episode Steps: 880
Episode Reward: -21.00 | Mean Reward: -20.31
Loss: 0.00322 | Epsilon: 0.513
Beta: 1.000


EPISODE 135 COMPLETED
======================================================================
Total Steps: 135873 | Episode Steps: 842
Episode Reward: -21.00 | Mean Reward: -20.31
Loss: 0.00309 | Epsilon: 0.511
Beta: 1.000


EPISODE 136 COMPLETED
======================================================================
Total Steps: 136734 | Episode Steps: 861
Episode Reward: -21.00 | Mean Reward: -20.31
Loss: 0.00312 | Epsilon: 0.508
Beta: 1.000


EPISODE 137 COMPLETED
======================================================================
Total Steps: 137675 | Episode Steps: 941
Episode Reward: -21.00 | Mean Reward: -20.32
Loss: 0.00321 | Epsilon: 0.506
Beta: 1.000


EPISODE 138 COMPLETED
======================================================================
Total Steps: 138574 | Episode Steps: 899
Episode Reward: -21.00 | Mean Reward: -20.34
Loss: 0.00294 | Epsilon: 0.503
Beta: 1.000


EPISODE 139 COMPLETED
======================================================================
Total Steps: 139417 | Episode Steps: 843
Episode Reward: -21.00 | Mean Reward: -20.35
Loss: 0.00257 | Epsilon: 0.501
Beta: 1.000


EPISODE 140 COMPLETED
======================================================================
Total Steps: 140270 | Episode Steps: 853
Episode Reward: -21.00 | Mean Reward: -20.36
Loss: 0.00312 | Epsilon: 0.498
Beta: 1.000


EPISODE 141 COMPLETED
======================================================================
Total Steps: 141559 | Episode Steps: 1289
Episode Reward: -17.00 | Mean Reward: -20.32
Loss: 0.00352 | Epsilon: 0.496
Beta: 1.000


EPISODE 142 COMPLETED
======================================================================
Total Steps: 142535 | Episode Steps: 976
Episode Reward: -20.00 | Mean Reward: -20.31
Loss: 0.00319 | Epsilon: 0.493
Beta: 1.000


EPISODE 143 COMPLETED
======================================================================
Total Steps: 143392 | Episode Steps: 857
Episode Reward: -21.00 | Mean Reward: -20.32
Loss: 0.00321 | Epsilon: 0.491
Beta: 1.000


EPISODE 144 COMPLETED
======================================================================
Total Steps: 144456 | Episode Steps: 1064
Episode Reward: -19.00 | Mean Reward: -20.30
Loss: 0.00341 | Epsilon: 0.488
Beta: 1.000


EPISODE 145 COMPLETED
======================================================================
Total Steps: 145297 | Episode Steps: 841
Episode Reward: -20.00 | Mean Reward: -20.29
Loss: 0.00356 | Epsilon: 0.486
Beta: 1.000


EPISODE 146 COMPLETED
======================================================================
Total Steps: 146208 | Episode Steps: 911
Episode Reward: -20.00 | Mean Reward: -20.28
Loss: 0.00364 | Epsilon: 0.483
Beta: 1.000


EPISODE 147 COMPLETED
======================================================================
Total Steps: 147107 | Episode Steps: 899
Episode Reward: -20.00 | Mean Reward: -20.27
Loss: 0.00336 | Epsilon: 0.481
Beta: 1.000


EPISODE 148 COMPLETED
======================================================================
Total Steps: 148000 | Episode Steps: 893
Episode Reward: -20.00 | Mean Reward: -20.27
Loss: 0.00369 | Epsilon: 0.479
Beta: 1.000


EPISODE 149 COMPLETED
======================================================================
Total Steps: 148967 | Episode Steps: 967
Episode Reward: -19.00 | Mean Reward: -20.26
Loss: 0.00354 | Epsilon: 0.476
Beta: 1.000


EPISODE 150 COMPLETED
======================================================================
Total Steps: 149822 | Episode Steps: 855
Episode Reward: -21.00 | Mean Reward: -20.26
Loss: 0.00378 | Epsilon: 0.474
Beta: 1.000


Checkpoint saved: checkpoints\DQN_PER_ep_150.pt
EPISODE 151 COMPLETED
======================================================================
Total Steps: 150613 | Episode Steps: 791
Episode Reward: -21.00 | Mean Reward: -20.28
Loss: 0.00314 | Epsilon: 0.471
Beta: 1.000


EPISODE 152 COMPLETED
======================================================================
Total Steps: 151547 | Episode Steps: 934
Episode Reward: -21.00 | Mean Reward: -20.28
Loss: 0.00343 | Epsilon: 0.469
Beta: 1.000


EPISODE 153 COMPLETED
======================================================================
Total Steps: 152424 | Episode Steps: 877
Episode Reward: -20.00 | Mean Reward: -20.28
Loss: 0.00329 | Epsilon: 0.467
Beta: 1.000


EPISODE 154 COMPLETED
======================================================================
Total Steps: 153387 | Episode Steps: 963
Episode Reward: -21.00 | Mean Reward: -20.31
Loss: 0.00310 | Epsilon: 0.464
Beta: 1.000


EPISODE 155 COMPLETED
======================================================================
Total Steps: 154346 | Episode Steps: 959
Episode Reward: -20.00 | Mean Reward: -20.30
Loss: 0.00351 | Epsilon: 0.462
Beta: 1.000


EPISODE 156 COMPLETED
======================================================================
Total Steps: 155700 | Episode Steps: 1354
Episode Reward: -18.00 | Mean Reward: -20.29
Loss: 0.00307 | Epsilon: 0.460
Beta: 1.000


EPISODE 157 COMPLETED
======================================================================
Total Steps: 156740 | Episode Steps: 1040
Episode Reward: -19.00 | Mean Reward: -20.28
Loss: 0.00344 | Epsilon: 0.458
Beta: 1.000


EPISODE 158 COMPLETED
======================================================================
Total Steps: 158118 | Episode Steps: 1378
Episode Reward: -17.00 | Mean Reward: -20.25
Loss: 0.00320 | Epsilon: 0.455
Beta: 1.000


EPISODE 159 COMPLETED
======================================================================
Total Steps: 159228 | Episode Steps: 1110
Episode Reward: -20.00 | Mean Reward: -20.24
Loss: 0.00325 | Epsilon: 0.453
Beta: 1.000


EPISODE 160 COMPLETED
======================================================================
Total Steps: 160261 | Episode Steps: 1033
Episode Reward: -21.00 | Mean Reward: -20.24
Loss: 0.00307 | Epsilon: 0.451
Beta: 1.000


EPISODE 161 COMPLETED
======================================================================
Total Steps: 161389 | Episode Steps: 1128
Episode Reward: -18.00 | Mean Reward: -20.21
Loss: 0.00318 | Epsilon: 0.448
Beta: 1.000


EPISODE 162 COMPLETED
======================================================================
Total Steps: 162268 | Episode Steps: 879
Episode Reward: -21.00 | Mean Reward: -20.23
Loss: 0.00338 | Epsilon: 0.446
Beta: 1.000


EPISODE 163 COMPLETED
======================================================================
Total Steps: 163271 | Episode Steps: 1003
Episode Reward: -21.00 | Mean Reward: -20.24
Loss: 0.00325 | Epsilon: 0.444
Beta: 1.000


EPISODE 164 COMPLETED
======================================================================
Total Steps: 164572 | Episode Steps: 1301
Episode Reward: -18.00 | Mean Reward: -20.21
Loss: 0.00317 | Epsilon: 0.442
Beta: 1.000


EPISODE 165 COMPLETED
======================================================================
Total Steps: 165685 | Episode Steps: 1113
Episode Reward: -19.00 | Mean Reward: -20.19
Loss: 0.00269 | Epsilon: 0.440
Beta: 1.000


EPISODE 166 COMPLETED
======================================================================
Total Steps: 166961 | Episode Steps: 1276
Episode Reward: -18.00 | Mean Reward: -20.16
Loss: 0.00297 | Epsilon: 0.437
Beta: 1.000


EPISODE 167 COMPLETED
======================================================================
Total Steps: 167899 | Episode Steps: 938
Episode Reward: -21.00 | Mean Reward: -20.17
Loss: 0.00329 | Epsilon: 0.435
Beta: 1.000


EPISODE 168 COMPLETED
======================================================================
Total Steps: 168896 | Episode Steps: 997
Episode Reward: -20.00 | Mean Reward: -20.16
Loss: 0.00315 | Epsilon: 0.433
Beta: 1.000


EPISODE 169 COMPLETED
======================================================================
Total Steps: 169997 | Episode Steps: 1101
Episode Reward: -19.00 | Mean Reward: -20.17
Loss: 0.00354 | Epsilon: 0.431
Beta: 1.000


EPISODE 170 COMPLETED
======================================================================
Total Steps: 170922 | Episode Steps: 925
Episode Reward: -20.00 | Mean Reward: -20.17
Loss: 0.00345 | Epsilon: 0.429
Beta: 1.000


EPISODE 171 COMPLETED
======================================================================
Total Steps: 171704 | Episode Steps: 782
Episode Reward: -21.00 | Mean Reward: -20.17
Loss: 0.00309 | Epsilon: 0.427
Beta: 1.000


EPISODE 172 COMPLETED
======================================================================
Total Steps: 172874 | Episode Steps: 1170
Episode Reward: -19.00 | Mean Reward: -20.17
Loss: 0.00304 | Epsilon: 0.424
Beta: 1.000


EPISODE 173 COMPLETED
======================================================================
Total Steps: 174101 | Episode Steps: 1227
Episode Reward: -20.00 | Mean Reward: -20.17
Loss: 0.00301 | Epsilon: 0.422
Beta: 1.000


EPISODE 174 COMPLETED
======================================================================
Total Steps: 175333 | Episode Steps: 1232
Episode Reward: -19.00 | Mean Reward: -20.17
Loss: 0.00286 | Epsilon: 0.420
Beta: 1.000


EPISODE 175 COMPLETED
======================================================================
Total Steps: 176474 | Episode Steps: 1141
Episode Reward: -18.00 | Mean Reward: -20.15
Loss: 0.00319 | Epsilon: 0.418
Beta: 1.000


EPISODE 176 COMPLETED
======================================================================
Total Steps: 177567 | Episode Steps: 1093
Episode Reward: -19.00 | Mean Reward: -20.15
Loss: 0.00375 | Epsilon: 0.416
Beta: 1.000


EPISODE 177 COMPLETED
======================================================================
Total Steps: 178435 | Episode Steps: 868
Episode Reward: -21.00 | Mean Reward: -20.15
Loss: 0.00345 | Epsilon: 0.414
Beta: 1.000


EPISODE 178 COMPLETED
======================================================================
Total Steps: 179247 | Episode Steps: 812
Episode Reward: -21.00 | Mean Reward: -20.15
Loss: 0.00312 | Epsilon: 0.412
Beta: 1.000


EPISODE 179 COMPLETED
======================================================================
Total Steps: 180430 | Episode Steps: 1183
Episode Reward: -19.00 | Mean Reward: -20.14
Loss: 0.00384 | Epsilon: 0.410
Beta: 1.000


EPISODE 180 COMPLETED
======================================================================
Total Steps: 181677 | Episode Steps: 1247
Episode Reward: -17.00 | Mean Reward: -20.11
Loss: 0.00322 | Epsilon: 0.408
Beta: 1.000


EPISODE 181 COMPLETED
======================================================================
Total Steps: 182760 | Episode Steps: 1083
Episode Reward: -20.00 | Mean Reward: -20.10
Loss: 0.00302 | Epsilon: 0.406
Beta: 1.000


EPISODE 182 COMPLETED
======================================================================
Total Steps: 184181 | Episode Steps: 1421
Episode Reward: -20.00 | Mean Reward: -20.09
Loss: 0.00304 | Epsilon: 0.404
Beta: 1.000


EPISODE 183 COMPLETED
======================================================================
Total Steps: 184963 | Episode Steps: 782
Episode Reward: -21.00 | Mean Reward: -20.09
Loss: 0.00304 | Epsilon: 0.402
Beta: 1.000


EPISODE 184 COMPLETED
======================================================================
Total Steps: 186083 | Episode Steps: 1120
Episode Reward: -21.00 | Mean Reward: -20.09
Loss: 0.00303 | Epsilon: 0.400
Beta: 1.000


EPISODE 185 COMPLETED
======================================================================
Total Steps: 186966 | Episode Steps: 883
Episode Reward: -21.00 | Mean Reward: -20.10
Loss: 0.00339 | Epsilon: 0.398
Beta: 1.000


EPISODE 186 COMPLETED
======================================================================
Total Steps: 187901 | Episode Steps: 935
Episode Reward: -21.00 | Mean Reward: -20.10
Loss: 0.00333 | Epsilon: 0.396
Beta: 1.000
