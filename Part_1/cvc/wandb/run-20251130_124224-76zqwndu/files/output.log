>>> Training starts at 2025-11-30 12:42:25.456026
>>> Hyperparameters:
    LR: 0.0001, Batch: 64, Gamma: 0.99
    Epsilon: 1.0 -> 0.01 (decay: 0.99)
    Update freq: 4, Sync freq: 1000
Filling replay buffer...
Buffer filled with 10000 experiences

=== BUFFER DIVERSITY CHECK ===
Sample states shape: (100, 4, 84, 84)
State mean: 0.4037
State std: 0.1905
Unique values check: 50
=== CHECK COMPLETE ===

Training a DQN network with Prioritized Replay Buffer
EPISODE 1 COMPLETED
======================================================================
Total Steps: 10842 | Episode Steps: 842
Episode Reward: -21.00 | Mean Reward: -21.00
Loss: 0.00480 | Epsilon: 1.000
Beta: 0.413



EPISODE 2 COMPLETED
======================================================================
Total Steps: 11828 | Episode Steps: 986
Episode Reward: -19.00 | Mean Reward: -20.00
Loss: 0.02101 | Epsilon: 0.990
Beta: 0.414



EPISODE 3 COMPLETED
======================================================================
Total Steps: 12927 | Episode Steps: 1099
Episode Reward: -20.00 | Mean Reward: -20.00
Loss: 0.02232 | Epsilon: 0.980
Beta: 0.416



EPISODE 4 COMPLETED
======================================================================
Total Steps: 13867 | Episode Steps: 940
Episode Reward: -21.00 | Mean Reward: -20.25
Loss: 0.02100 | Epsilon: 0.970
Beta: 0.417



EPISODE 5 COMPLETED
======================================================================
Total Steps: 14805 | Episode Steps: 938
Episode Reward: -21.00 | Mean Reward: -20.40
Loss: 0.02210 | Epsilon: 0.961
Beta: 0.418



EPISODE 6 COMPLETED
======================================================================
Total Steps: 15643 | Episode Steps: 838
Episode Reward: -21.00 | Mean Reward: -20.50
Loss: 0.01719 | Epsilon: 0.951
Beta: 0.419



EPISODE 7 COMPLETED
======================================================================
Total Steps: 16590 | Episode Steps: 947
Episode Reward: -21.00 | Mean Reward: -20.57
Loss: 0.01150 | Epsilon: 0.941
Beta: 0.420



EPISODE 8 COMPLETED
======================================================================
Total Steps: 17532 | Episode Steps: 942
Episode Reward: -21.00 | Mean Reward: -20.62
Loss: 0.00891 | Epsilon: 0.932
Beta: 0.421



EPISODE 9 COMPLETED
======================================================================
Total Steps: 18664 | Episode Steps: 1132
Episode Reward: -19.00 | Mean Reward: -20.44
Loss: 0.00836 | Epsilon: 0.923
Beta: 0.422



EPISODE 10 COMPLETED
======================================================================
Total Steps: 19671 | Episode Steps: 1007
Episode Reward: -20.00 | Mean Reward: -20.40
Loss: 0.00734 | Epsilon: 0.914
Beta: 0.424



EPISODE 11 COMPLETED
======================================================================
Total Steps: 20600 | Episode Steps: 929
Episode Reward: -20.00 | Mean Reward: -20.36
Loss: 0.00714 | Epsilon: 0.904
Beta: 0.425



EPISODE 12 COMPLETED
======================================================================
Total Steps: 21730 | Episode Steps: 1130
Episode Reward: -19.00 | Mean Reward: -20.25
Loss: 0.00681 | Epsilon: 0.895
Beta: 0.426



EPISODE 13 COMPLETED
======================================================================
Total Steps: 22600 | Episode Steps: 870
Episode Reward: -21.00 | Mean Reward: -20.31
Loss: 0.00705 | Epsilon: 0.886
Beta: 0.427



EPISODE 14 COMPLETED
======================================================================
Total Steps: 23470 | Episode Steps: 870
Episode Reward: -21.00 | Mean Reward: -20.36
Loss: 0.00706 | Epsilon: 0.878
Beta: 0.428



EPISODE 15 COMPLETED
======================================================================
Total Steps: 24516 | Episode Steps: 1046
Episode Reward: -19.00 | Mean Reward: -20.27
Loss: 0.00703 | Epsilon: 0.869
Beta: 0.429



EPISODE 16 COMPLETED
======================================================================
Total Steps: 25477 | Episode Steps: 961
Episode Reward: -19.00 | Mean Reward: -20.19
Loss: 0.00771 | Epsilon: 0.860
Beta: 0.431



EPISODE 17 COMPLETED
======================================================================
Total Steps: 26432 | Episode Steps: 955
Episode Reward: -20.00 | Mean Reward: -20.18
Loss: 0.00686 | Epsilon: 0.851
Beta: 0.432



EPISODE 18 COMPLETED
======================================================================
Total Steps: 27429 | Episode Steps: 997
Episode Reward: -19.00 | Mean Reward: -20.11
Loss: 0.00679 | Epsilon: 0.843
Beta: 0.433



EPISODE 19 COMPLETED
======================================================================
Total Steps: 28383 | Episode Steps: 954
Episode Reward: -20.00 | Mean Reward: -20.11
Loss: 0.00668 | Epsilon: 0.835
Beta: 0.434



EPISODE 20 COMPLETED
======================================================================
Total Steps: 29304 | Episode Steps: 921
Episode Reward: -21.00 | Mean Reward: -20.15
Loss: 0.00646 | Epsilon: 0.826
Beta: 0.435



EPISODE 21 COMPLETED
======================================================================
Total Steps: 30415 | Episode Steps: 1111
Episode Reward: -20.00 | Mean Reward: -20.14
Loss: 0.00695 | Epsilon: 0.818
Beta: 0.436



EPISODE 22 COMPLETED
======================================================================
Total Steps: 31276 | Episode Steps: 861
Episode Reward: -21.00 | Mean Reward: -20.18
Loss: 0.00701 | Epsilon: 0.810
Beta: 0.438



EPISODE 23 COMPLETED
======================================================================
Total Steps: 32247 | Episode Steps: 971
Episode Reward: -21.00 | Mean Reward: -20.22
Loss: 0.00636 | Epsilon: 0.802
Beta: 0.439



EPISODE 24 COMPLETED
======================================================================
Total Steps: 33445 | Episode Steps: 1198
Episode Reward: -18.00 | Mean Reward: -20.12
Loss: 0.00669 | Epsilon: 0.794
Beta: 0.440



EPISODE 25 COMPLETED
======================================================================
Total Steps: 34227 | Episode Steps: 782
Episode Reward: -21.00 | Mean Reward: -20.16
Loss: 0.00651 | Epsilon: 0.786
Beta: 0.441



EPISODE 26 COMPLETED
======================================================================
Total Steps: 35194 | Episode Steps: 967
Episode Reward: -19.00 | Mean Reward: -20.12
Loss: 0.00676 | Epsilon: 0.778
Beta: 0.442



EPISODE 27 COMPLETED
======================================================================
Total Steps: 36178 | Episode Steps: 984
Episode Reward: -19.00 | Mean Reward: -20.07
Loss: 0.00704 | Epsilon: 0.770
Beta: 0.443



EPISODE 28 COMPLETED
======================================================================
Total Steps: 36969 | Episode Steps: 791
Episode Reward: -21.00 | Mean Reward: -20.11
Loss: 0.00702 | Epsilon: 0.762
Beta: 0.444



EPISODE 29 COMPLETED
======================================================================
Total Steps: 37907 | Episode Steps: 938
Episode Reward: -20.00 | Mean Reward: -20.10
Loss: 0.00734 | Epsilon: 0.755
Beta: 0.445



EPISODE 30 COMPLETED
======================================================================
Total Steps: 38806 | Episode Steps: 899
Episode Reward: -21.00 | Mean Reward: -20.13
Loss: 0.00716 | Epsilon: 0.747
Beta: 0.447



EPISODE 31 COMPLETED
======================================================================
Total Steps: 40031 | Episode Steps: 1225
Episode Reward: -18.00 | Mean Reward: -20.06
Loss: 0.00661 | Epsilon: 0.740
Beta: 0.448



EPISODE 32 COMPLETED
======================================================================
Total Steps: 41050 | Episode Steps: 1019
Episode Reward: -20.00 | Mean Reward: -20.06
Loss: 0.00741 | Epsilon: 0.732
Beta: 0.449



EPISODE 33 COMPLETED
======================================================================
Total Steps: 42070 | Episode Steps: 1020
Episode Reward: -19.00 | Mean Reward: -20.03
Loss: 0.00692 | Epsilon: 0.725
Beta: 0.450



EPISODE 34 COMPLETED
======================================================================
Total Steps: 42923 | Episode Steps: 853
Episode Reward: -21.00 | Mean Reward: -20.06
Loss: 0.00721 | Epsilon: 0.718
Beta: 0.452



EPISODE 35 COMPLETED
======================================================================
Total Steps: 44058 | Episode Steps: 1135
Episode Reward: -18.00 | Mean Reward: -20.00
Loss: 0.00759 | Epsilon: 0.711
Beta: 0.453



EPISODE 36 COMPLETED
======================================================================
Total Steps: 44964 | Episode Steps: 906
Episode Reward: -20.00 | Mean Reward: -20.00
Loss: 0.00681 | Epsilon: 0.703
Beta: 0.454



EPISODE 37 COMPLETED
======================================================================
Total Steps: 46322 | Episode Steps: 1358
Episode Reward: -18.00 | Mean Reward: -19.95
Loss: 0.00710 | Epsilon: 0.696
Beta: 0.456



EPISODE 38 COMPLETED
======================================================================
Total Steps: 47233 | Episode Steps: 911
Episode Reward: -21.00 | Mean Reward: -19.97
Loss: 0.00738 | Epsilon: 0.689
Beta: 0.457



EPISODE 39 COMPLETED
======================================================================
Total Steps: 48055 | Episode Steps: 822
Episode Reward: -21.00 | Mean Reward: -20.00
Loss: 0.00637 | Epsilon: 0.683
Beta: 0.458



EPISODE 40 COMPLETED
======================================================================
Total Steps: 49156 | Episode Steps: 1101
Episode Reward: -17.00 | Mean Reward: -19.93
Loss: 0.00609 | Epsilon: 0.676
Beta: 0.459



EPISODE 41 COMPLETED
======================================================================
Total Steps: 50070 | Episode Steps: 914
Episode Reward: -20.00 | Mean Reward: -19.93
Loss: 0.00649 | Epsilon: 0.669
Beta: 0.460



EPISODE 42 COMPLETED
======================================================================
Total Steps: 51087 | Episode Steps: 1017
Episode Reward: -19.00 | Mean Reward: -19.90
Loss: 0.00708 | Epsilon: 0.662
Beta: 0.461



EPISODE 43 COMPLETED
======================================================================
Total Steps: 52090 | Episode Steps: 1003
Episode Reward: -21.00 | Mean Reward: -19.93
Loss: 0.00715 | Epsilon: 0.656
Beta: 0.463



EPISODE 44 COMPLETED
======================================================================
Total Steps: 52965 | Episode Steps: 875
Episode Reward: -21.00 | Mean Reward: -19.95
Loss: 0.00676 | Epsilon: 0.649
Beta: 0.464



EPISODE 45 COMPLETED
======================================================================
Total Steps: 53883 | Episode Steps: 918
Episode Reward: -20.00 | Mean Reward: -19.96
Loss: 0.00673 | Epsilon: 0.643
Beta: 0.465



EPISODE 46 COMPLETED
======================================================================
Total Steps: 55066 | Episode Steps: 1183
Episode Reward: -18.00 | Mean Reward: -19.91
Loss: 0.00600 | Epsilon: 0.636
Beta: 0.466



EPISODE 47 COMPLETED
======================================================================
Total Steps: 56224 | Episode Steps: 1158
Episode Reward: -19.00 | Mean Reward: -19.89
Loss: 0.00605 | Epsilon: 0.630
Beta: 0.467



EPISODE 48 COMPLETED
======================================================================
Total Steps: 57295 | Episode Steps: 1071
Episode Reward: -20.00 | Mean Reward: -19.90
Loss: 0.00550 | Epsilon: 0.624
Beta: 0.469



EPISODE 49 COMPLETED
======================================================================
Total Steps: 58339 | Episode Steps: 1044
Episode Reward: -20.00 | Mean Reward: -19.90
Loss: 0.00567 | Epsilon: 0.617
Beta: 0.470



EPISODE 50 COMPLETED
======================================================================
Total Steps: 59340 | Episode Steps: 1001
Episode Reward: -21.00 | Mean Reward: -19.92
Loss: 0.00558 | Epsilon: 0.611
Beta: 0.471



Checkpoint saved: checkpoints/DQN_PER_ep_50.pt
Removed old checkpoint: checkpoints/DQN_PER_ep_50.pt
/home/anavarror/paradigms/Agent.py:431: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  best_checkpoint = torch.load(latest_best)
EPISODE 51 COMPLETED
======================================================================
Total Steps: 60656 | Episode Steps: 1316
Episode Reward: -17.00 | Mean Reward: -19.86
Loss: 0.00564 | Epsilon: 0.605
Beta: 0.473



EPISODE 52 COMPLETED
======================================================================
Total Steps: 62033 | Episode Steps: 1377
Episode Reward: -18.00 | Mean Reward: -19.83
Loss: 0.00620 | Epsilon: 0.599
Beta: 0.474
